{"version":3,"sources":["../../src/controller/user.js"],"names":["config","db","api","post","req","res","newUser","username","body","email","phonenumber","profilepicurlicUrl","profilepicurl","save","err","status","json","message","get","find","users","findById","params","id","user","put","name","avatarName","avatarColor","findOne","exec","userData","delete","remove","_id"],"mappings":"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","file":"user.js","sourcesContent":["import mongoose from 'mongoose';\nimport { Router } from 'express';\nimport bodyParser from 'body-parser';\nimport User from '../model/user';\n\nimport { authenticate } from '../middleware/authMiddleware';\n\nexport default({ config, db }) => {\n  let api = Router();\n\n  // '/v1/user/add' - Create\n  api.post('/add', authenticate, (req, res) => {\n    let newUser = new User();\n    newUser.username = req.body.username;\n    newUser.email = req.body.email;\n    newUser.phonenumber = req.body.phonenumber;\n    newUser.profilepicurlicUrl = req.body.profilepicurl;\n\n    newUser.save(err => {\n      if (err) {\n        res.status(500).json({ message: err });\n        return;\n      }\n      res.status(200).json(newUser);\n    });\n  });\n\n  // '/v1/user/' - Read\n  api.get('/', authenticate, (req, res) => {\n    User.find({}, (err, users) => {\n      if (err) {\n        res.status(500).json({ message: err });\n        return;\n      }\n      res.status(200).json(users);\n    });\n  });\n\n  // '/v1/user/:id' - Read 1\n  api.get('/:id', authenticate, (req, res) => {\n    User.findById(req.params.id, (err, user) => {\n      if (err) {\n        res.status(500).json({ message: err });\n        return;\n      }\n      res.status(200).json(user);\n    });\n  });\n\n  // '/v1/user/:id' - Update\n  api.put('/:id', authenticate, (req, res) => {\n    User.findById(req.params.id, (err, user) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      user.name = req.body.name;\n      user.email = req.body.email;\n      user.avatarName = req.body.avatarName;\n      user.avatarColor = req.body.avatarColor;\n      user.save(err => {\n        if (err) {\n          res.status(500).json({ message: err });\n          return;\n        }\n        res.status(200).json({ message: 'User info updated' });\n      });\n    });\n  });\n\n  // 'v1/user/byEmail/:email'\n  api.get('/byEmail/:email', authenticate, (req, res) => {\n    User\n      .findOne({ 'email': req.params.email })\n      .exec((err, userData) => {\n        if (err) {\n          res.status(500).json({ message: err });\n          return;\n        }\n        res.status(200).json(userData);\n      });\n  });\n\n  //'v1/user/byId/:id'\n  api.get('/byId/:id', authenticate, (req, res) => {\n    User.findById(req.params.id, (err, user) => {\n      if (err) {\n        res.status(500).json({message: `An error has occured ${err. message}`});\n        return;\n      }\n          res.status(200).json(user);\n    })\n  })\n\n  // '/vq/user/:id' -Delete\n  api.delete('/:id', authenticate, (req, res) => {\n    User.remove({\n      _id: req.params.id\n    }, (err, user) => {\n      if (err) {\n        res.status(500).json({ message: err });\n        return;\n      }\n      res.status(200).json({ message: 'User Successfully Removed'});\n    });\n  });\n\n  // '/v1/user/' - Delete all\n  api.delete('/', authenticate, (req, res) => {\n    User.find({}, (err, users) => {\n      if (err) {\n        res.status(500).json({ message: err });\n        return;\n      }\n      res.status(200).json({ message: 'All Users Removed'});\n    });\n  });\n\n  return api;\n}\n"]}